<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Utilities - Mimosa</title>
  <meta name="description" content="All the extra bits you have to have.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <link rel="stylesheet" href="css/main.css"> -->
  <link rel="stylesheet" href="css/bootstrap.min.css" >
  <link rel="stylesheet" href="css/bootstrap-responsive.min.css" >
  <link rel="stylesheet" href="css/app.css">

  <link rel="shortcut icon" href="img/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="img/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="img/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="img/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="img/apple-touch-icon-57-precomposed.png">
</head>
<body data-spy="scroll" data-target=".subnav" data-offset="50">

  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <div class="nav-collapse collapse">
          <ul class="nav">
            <li class="">
              <a href="./index.html">Mimosa</a>
            </li>
            <li class="">
              <a href="./started.html">Get Started</a>
            </li>
            <li class="">
              <a href="./commands.html">Commands</a>
            </li>
            <li class="">
              <a href="./compilers.html">Compilers</a>
            </li>
            <li  class="">
              <a href="./modules.html">Modules</a>
            </li>
            <li class="">
              <a href="./server.html">Serve</a>
            </li>
            <li class="active">
              <a href="./utilities.html">Utilities</a>
            </li>
            <li class="">
              <a href="./optimization.html">Optimization</a>
            </li>
            <li class="">
              <a href="./configuration.html">Configuration</a>
            </li>
            <li class="">
              <a href="./about.html">About/FAQ</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

<div class="container main">

  <header class="jumbotron subhead" id="overview">
    <h1>Utilities</h1>
    <p class="lead">All the little things that add up to win.</p>
    <div class="subnav">
      <ul class="nav nav-pills">
        <li><a href="#requirejs" title="Lint your assets">RequireJS Support</a></li>
        <li><a href="#lint" title="Lint your assets">Linting</a></li>
        <li><a href="#reload" title="Never refresh your browser again">Live Reload</a></li>
        <li><a href="#notify" title="Find out right away when thigs go horribly wrong">Notifications</a></li>
        <li><a href="#gzip" title="Keep your assets nice and small">GZip</a></li>
        <li><a href="#cache" title="Keep your assets nice and small">Cache Busting</a></li>
        <li><a href="#profiles" title="Tweak the config using Profiles">Run Profiles</a></li>
      </ul>
    </div>
  </header>

  <section class="command-list">
    <section id="requirejs" >
      <div class="page-header">
        <h1>
          RequireJS Support
          <small><span class="options">maps and shims and paths, o my</span></small>
        </h1>
      </div>
      <div class="row">
        <div class="span6">
          <p>Mimosa comes with a bunch of AMD/RequireJS support.  Mimosa will...</p>

          <ul>
             <li>Verify paths when JavaScript successfully compiles. Mimosa will follow relative paths for dependencies, and also use config paths whether they resolve to an actual dependency, <code class="option">jquery: 'vendor/jquery'</code>, or they resolve to a module, <code class="option">moduleX:'a/path/to/module/x'</code>.
            <li>Detect dependencies embedded within <code class="option">define</code> and <code class="option">require</code> callbacks. i.e. deferred <code class="option">require</code> calls.</li>
            <li>Verify map and shim paths, and keep track of the map config and use it for path verification.</li>
            <li>Notify when paths are broken. An unresolved path is as crucial as a compiler error: code is broken.</li>
            <li>Catch circular dependencies and notify on the console.</li>
            <li>Catch when a non-vendor piece of compiled JavaScript isn't wrapped in <code class="option">require</code> or <code class="option">define</code> and notify you on the console.</li>
            <li>Run RequireJS' optimizer when the <code class="option">optimize</code> flag is enabled for <code class="option">mimosa build</code>, and on every file change for <code class="option">mimosa watch</code>.</li>
            <li>Need no config at all for the optimizer, which takes some time to configure. Mimosa will keep track of dependencies and build a vanilla optimizer configuration.</li>
            <li>For complex r.js configurations, allow modification of pre-built inferred configs rather than needing from-scratch configurations.</li>
            <li>Handle multi-page applications with multiple modules.</li>
            <li>Detect and use common RequireJS configuration used across multiple modules</li>
            <li>Only compile those modules that need compiling based on changed code.</li>
            <li>Bundle optimized JavaScript with <a href="https://github.com/jrburke/almond">Almond</a></li>
          </ul>

        </div>
        <div class="span6">
          <div class="term">
            <div class="inner">
              18:59:06 - RequireJS dependency [[ controller ]] for path alias [[ c ]], inside file [[ /Users/dbashford/mygithub/AngularFunMimosa/public/javascripts/main.js ]], cannot be found.<br/>
              18:59:22 - RequireJS shim [[ ang ]] inside file [[ /Users/dbashford/mygithub/AngularFunMimosa/public/javascripts/main.js ]] refers to a dependency that cannot be found [[ vendo/modernizr ]].<br/>
              18:59:33 - RequireJS dependency [[ c/gitHu ]], inside file [[ /Users/dbashford/mygithub/AngularFunMimosa/public/javascripts/main.js ]], cannot be found.<br/>
              18:59:43 - RequireJS mapping inside file [[ /Users/dbashford/mygithub/AngularFunMimosa/public/javascripts/main.js ]], for module [[ * ]] has path that cannot be found [[ vendor/angular-resourc ]].
            </div>
          </div>
<pre># require:
  # exclude:[]
  # commonConfig:"common"
  # verify:
    # enabled: true
  # optimize :
    # inferConfig:true
    # overrides:</pre>

        </div>
      </div>

      <p>Path verification can be turned off using the configuration shown here.  Set enabled to <code class="option">false</code>. For information about how Mimosa uses RequireJS to optimize your application, check out the <a href="file:///Users/dbashford/mygithub/mimosajs.com/optimization.html">Optimization</a> tab.</p>

      <p>Path verification is always disabled for vendor assets, that is, assets located inside a <code class="option">vendor</code> directory.  Vendor assets often use creative means to turn themselves into AMD modules that prove hard to verify.  That said, if a vendor asset is placed outside the vendor folder, Mimosa is coded to handle how some of the methods vendor assets are AMDed. But Mimosa may complain that some vendor assets are throwing errors or are not properly wrapped.</p>

      <p>To read more about Mimosa's RequireJS support, head over to the <a href="./optimization.html">Optimization</a> page.</p>

      <p>Mimosa's RequireJS support comes from the <code class="option">mimosa-require</code> module, a default Mimosa module that comes installed with Mimosa. For more on modules, see the <a href="./modules.html">Modules</a> page.</p>

    </section>
    <section id="lint">
      <div class="page-header">
        <h1>
          Linting
          <small><span class="options">keep your code idiomatic</span></small>
        </h1>
      </div>
      <div class="row">
        <div class="span8">
          <p>To 'lint' code is to check it for common mistakes or variances from the idiom. Mimosa will automatically lint all of the CSS and JavaScript it moves from source directories to compiled directories. Any errors or warnings that come out of linting will be printed to the console but will not stop or fail the compilation. Inside the <code class="option">mimosa-config</code> is the snippet to the right which controls the linting. As with all of the default config, this is entirely commented out as the defaults are already enforced.</p>

          <p>Mimosa's Linting support comes courtesy of the <code class="option">mimosa-lint</code> module, a default Mimosa module that comes installed with Mimosa.  For more on modules, see the <a href="./modules.html">Modules</a> page.</p>

          <h2>Linting Compiled Assets</h2>

          <p>The <code class="option">compiled</code> block controls whether or not linting is enabled for compiled code. So when Mimosa compiles SASS, LESS or Stylus, Mimosa will send the resulting CSS through a linting process. Similarly for the JavaScript meta-languages, Mimosa will lint the resulting JavaScript.</p>

          <h2>Linting Copied Assets</h2>

          <p>The <code class="option">copied</code> settings determine whether or not to lint copied files, like hand-coded JavaScript.</p>

        </div>

        <div class="span4">
<pre># lint:
  # exclude:[]
  # compiled:
    # javascript:true
    # css:true
  # copied:
    # javascript: true
    # css: true
  # vendor:
    # javascript: false
    # css: false
  # rules:
    # jshintrc: ".jshintrc"
    # js:
      # plusplus: true
    # css:
      # floats: false</pre>
        </div>
      </div>

      <h2>Linting Vendor Assets</h2>

      <p>Mimosa also allows control over the linting of code contained in the <code class="option">vendor</code> directory. Linting is, by default, disabled for vendor assets, that is, those assets living inside a <code class="option">/vendor/</code> directory. Vendor libraries often break from the idiom, or use hacks, to solve complex browser issues for you. For example, when run through CSSLint, Bootstrap causes 400+ warnings.</p>

      <p>To enable vendor asset hinting, uncomment enable the setting and switch the flags to <code class="option">true</code>.</p>

      <h2>Lint Rules</h2>

      <p>The <code class="option">rules</code> block is where linting rules for each of the linting tools are overridden or changed. Example overrides are provided in the default configuration. Those are examples, they are not actually overrides.</p>

      <p>For CoffeeScript and IcedCoffeeScript some jshint rules are turned off by default. Those compilers output JavaScript that violates jshint and there is nothing that can be done other than turn the rules off. So when compiling those files, Mimosa will turn off the following rules by default:</p>

      <pre>boss: true
eqnull: true
shadow: true
expr: true</pre>

      <h2>JSHint, CSSLint</h2>

      <p>Both of the lint/hinters come with default configurations that Mimosa uses. Here are links to the tools, as well as to the configuration for those tools.</p>

      <ul>
        <li><a href="http://www.jshint.com/">JSHint</a>, <a href="http://www.jshint.com/">JSHint Rules Definitions</a></li>
        <li><a href="http://csslint.net/">CSSLint</a>, <a href="https://github.com/stubbornella/csslint/wiki/Rules">CSSLint Rules Definitions</a></li>
      </ul>

    </section>
    <section id="reload">
      <div class="page-header">
        <h1>
          Live Reload
          <small><span class="options">so simple, such a time saver</span></small>
        </h1>
      </div>

      <p>Mimosa provides live reload support by default via the <code class="option">mimosa-live-reload</code> module. Live reload will immediately refresh a page any time an asset is compiled or a view changes.</p>

      <p><code class="option">mimosa-live-reload</code> handles CSS and JavaScript assets differently. For CSS the page does not need a full reload.  The new CSS is re-evaluated without reloading anything other than the CSS. The page is simply repainted. When JavaScript assets are updated, the entire page refreshes.</p>

      <p>This sounds like a fairly small nice-to-have feature, but it quickly becomes one of the handiest time savers in your workflow. Mimosa and Live Reload are often fast enough to get the page reloaded before the browser can be toggled to.</p>

      <p>If <code class="option">mimosa new</code> was used to create the project, then live reload will already be included. If enabling it on an existing project, some minor things need to change on both the client and server to use it.</p>

      <h2>Client Scripts</h2>

      <p>For live reload to work, two scripts need to be added to the page.  If using dynamic templating for views, then the scripts need to be included for development and not included when in production.</p>

      <p>The paths to use for the two scripts are:</p>

      <ul>
        <li><code class="option">/socket.io/socket.io.js</code>: This is <a href="http://socket.io/">socket.io</a>. Mimosa will serve this file, so it need not be in the project's codebase, but a script tag must pull it in. socket.io is what allows instant communication of server-side changes to the client. socket.io will emit events on the client that indicate that a JavaScript file has changed, or a CSS file has changed.</li>
        <li><code class="option">/javascripts/reload-client.js</code>: This is a small piece of code that reacts to events emitted by socket.io. When it hears from socket.io that a piece of CSS has changed, it reloads the CSS.  When it hears that some JavaScript has changed, it refreshes the page.</li>
      </ul>

      <h2>Server Component</h2>

      <p>If Mimosa is serving assets, there is nothing to do on the server.</p>

      <p>If running a node server that Mimosa is starting, then the callback that Mimosa passes <code class="option">startServer</code> needs to be passed the http server object. This is the same object returned by <code class="option">require('http').createServer()</code> and by <code class="option">express().listen()</code>. The <code class="option">mimosa-live-reload</code> module needs access to the server to establish a connection between the socket.io client and the server.</p>

      <h2>Already using socket.io?</h2>

      <p>This pertains to those who are using their own server, not Mimosa's.  The <code class="option">mimosa-live-reload</code> module uses socket.io in conjunction with the server passed to the <code class="option">startServer</code> callback function to provide live reload functionality. But if socket.io is already being used, Mimosa's use of socket.io will cause problems.</p>

      <p>If socket.io is already being used, then it must also be given to the callback function executed at the end of <code class="option">startServer</code>. The first parameter passed to the callback should be the server, and the second should be the object returned by <code class="option">socketio.listen(server)</code>. If this object is provided, <code class="option">mimosa-live-reload</code> will not create its own socketio connection, and instead use the existing one.</p>

      <h2>How about Live Reload for Your Server?</h2>

      <p>Via an <a href="https://github.com/dbashford/mimosa-server-reload">external module</a> you can restart your server anytime certain files change.  This is yet another time saver.</p>

    </section>
    <section id="notify">
      <div class="page-header">
        <h1>
          Notifications - Immediate Feedback
          <small><span class="options">find out right now that something is broken</span></small>
        </h1>
      </div>

      <p>Compilation of assets is kicked off as soon as a file is saved. Mimosa will write to the console the outcome of every compilation event. Should compilation fail, the reason will be included in the log message.</p>

      <div class="row">
        <div class="span8">
          <h2>Growl</h2>

          <p>If <a href="http://growl.info/">Growl</a> is installed and turned on, a Growl notification will be created for each failed or successful asset compile. In the event Growl gets too spammy, Growl notifications can be turned off for successful compiles. Growl has its own setting in Mimosa, the defaults are to the right.</p>

          <p>If  <a href="./commands.html#clean">clean</a> in run on a project and then <a href="./commands.html#watch">watch</a> is started, Mimosa will compile every asset. If there are dozens or hundreds of assets, Growl notifications may not be desirable for each successful compile during startup. Startup success notifications are off by default, but can be turned on by uncommenting the config and setting the <code class="option">growl.onStartup</code> flag to true.</p>

          <p>To allow Mimosa to use Growl, an extra library needs to be installed. For details on installation on your system, check out the <a href="https://github.com/visionmedia/node-growl#install">node-growl</a> page.</a>

        </div>
        <div class="span4">
<pre># growl:
  # onStartup: false
  # onSuccess:
    # javascript: true
    # css: true
    # template: true
    # copy: true</pre>
        </div>
      </div>

      <p>Post-startup success notifications can be turned off for compiled javascript, css, and templates, as well as for copied assets by altering the <code class="option">growl.onSuccess</code> flats. These notifications are on by default.</p>

    </section>

    <section id="gzip">
      <div class="page-header">
        <h1>
          GZip Your Assets
          <small><span class="options">because size matters</span></small>
        </h1>
      </div>
      <p>All static assets will be served up <a href="http://en.wikipedia.org/wiki/Gzip">GZip</a>-ed! 'nuff said.</p>
    </section>

    <section id="cache" >
      <div class="page-header">
        <h1>
          Cache Busting
          <small><span class="options">no more shift-f5 and pray</span></small>
        </h1>
      </div>
      <p>No forcing a refresh to bypass caching issues. All JavaScript and CSS files are cache-busted during development.</p>

      <p>JavaScript cache-busting is done via the <code class="option">urlArgs</code> parameter with RequireJS.  That can cause some problems if you are doing breakpoint debugging in the client.  You'll want to comment out the <code class="option">urlArgs</code> if you do that kind of debugging.</p>

    </section>

    <section id="profiles" >
      <div class="page-header">
        <h1>
          Run Profiles
          <small><span class="options">override the mimosa-config at runtime</span></small>
        </h1>
      </div>

      <p>Profiles allow for overriding of <code class="option">mimosa-config</code> settings via external config files. A project might have a "build" profile that is used for automated builds, and for those builds maybe certain modules aren't needed. For instance the "lint" module can be left out of the modules array.</p>

      <p>Profiles are implemented as <code class="option">mimosa-config</code> files. Any properties of a project's <code class="option">mimosa-config</code> that need to be overridden would be the properties placed in a profile file.</p>

      <p>By default, profile files should be located in a <code class="option">profiles/</code> directory at the root of a Mimosa project. This location can be overridden via the <code class="option">profileLocation</code> property in the project's <code class="option">mimosa-config</code>.  <code class="option">profileLocation</code> is relative to the root of the project.</p>

      <p>Profiles can be used for the <code class="option">watch</code>, <code class="option">build</code> and <code class="option">clean</code> commands. Each of those commands have a <code class="option">-P/--profile</code> flag. Follow the flag with the name of the profile to use and Mimosa will pull that profile in and use it to override the settings in the <code class="option">mimosa-config</code>. Ex: <code class="option">mimosa build -P build</code>.

    </section>

  </section>

</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.7.2.min.js"><\/script>')</script>
<script src="js/vendor/bootstrap-collapse.js"></script>
<script src="js/vendor/bootstrap-scrollspy.js"></script>

<!-- scripts concatenated and minified via build script -->
<script src="js/plugins.js"></script>
<script src="js/main.js"></script>
<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
<!-- end scripts -->

<script>
    var _gaq=[['_setAccount','UA-33737130-1'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>
